fas2mat <- function(xfas){

  #Monta em S uma lista só com as sequencia de bases da variavel xfas
  S <-list()
  S<-seqinr::getSequence(xfas)

  #Aplica a função aa2mat em individualmente em cada sequencia de S
  S<-vapply(S,aa2mat,FUN.VALUE =double(160000))
  t(S)
}
aa2mat <- function(xseq){
  #Esta função cria matriz binaria, com base nas combrinaçoes de pares de bases encontradas com a comparação da mascara

  nucol<- 5
  #Cria uma matriz com colunas = "nucol", que percorre de 5 em 5 todas bases da sequencia
  L5 <- dna2list(xseq,nucol);
  L5 <-L5[[1]]

  #Atribui uma cordenada (X,Y) para cada combinação de pares de base
  xy <- cbind(aa2num2(L5[ ,1:2]), aa2num2(L5[ ,4:nucol]))

  pinot<-(1-matrix(xy<=0,ncol=2))
  inot<- which(matrix(as.numeric(!(pinot[ ,1]*pinot[ ,2])), ncol = 1)!=0)
  xy[inot, ] <- NA

  #Cria indices em para uma matriz 400X400 com base nas cordenadas de xy
  inds <- ij2inds(xy,400)
  inds[inds>(160000)] <- NA

  #Cria uma mariz M composta de zeros e atribui 1 nas posiçoes de inds
  M <-matrix(0,ncol= 400,nrow = 400)
  M[inds]<-1
  c(M)

}
